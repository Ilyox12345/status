<!-- Site complet de status BumpX avec accÃ¨s admin Discord (337868737871085578 et 924263589798346762) -->
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BumpX - Status</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
/* MÃªme thÃ¨me visuel que ta page d'attente */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{background:linear-gradient(135deg,#f5f7fa,#e3e9ff);color:#111;overflow-x:hidden;}
.shape{position:absolute;opacity:.12;filter:blur(2px);animation:float 18s ease-in-out infinite;}
.circle{width:420px;height:420px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);top:-80px;left:-80px;}
.square{width:350px;height:350px;border-radius:35px;background:linear-gradient(135deg,#5865F2,#3b4de0);bottom:-120px;right:-60px;animation-delay:-7s;}
@keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-40px)}100%{transform:translateY(0)}}

/* Container */
.card{width:90%;max-width:900px;margin:160px auto;padding:60px 50px;background:rgba(255,255,255,0.65);border-radius:35px;backdrop-filter:blur(15px);box-shadow:0 15px 60px rgba(0,0,0,0.1);text-align:center;}
.title{font-size:60px;font-weight:900;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-text-fill-color:transparent;-webkit-background-clip:text;}
.status-box{margin:25px auto;font-size:30px;font-weight:700;padding:20px;border-radius:20px;width:70%;}
.online{background:rgba(0,255,0,.15);border:2px solid #22c55e;}
.offline{background:rgba(255,0,0,.15);border:2px solid #ef4444;}
.maintenance{background:rgba(255,217,0,.2);border:2px solid #eab308;}
.info{margin-top:30px;text-align:left;}
.info-item{background:rgba(255,255,255,0.5);padding:15px 20px;margin:12px 0;border-radius:15px;display:flex;justify-content:space-between;font-size:18px;font-weight:600;}

/* ADMIN */
.admin-title{margin-top:40px;font-size:40px;font-weight:800;background:linear-gradient(135deg,#5865F2,#3b4de0);-webkit-text-fill-color:transparent;-webkit-background-clip:text;}
.admin-box{margin-top:25px;padding:25px;background:rgba(255,255,255,0.5);border-radius:20px;}
.admin-btn{padding:15px 35px;border-radius:12px;background:linear-gradient(135deg,#5865F2,#3b4de0);color:white;font-size:18px;border:none;cursor:pointer;font-weight:600;transition:.3s;margin:10px;}
.admin-btn:hover{transform:translateY(-5px);}

footer{text-align:center;padding:40px;color:#444;margin-top:80px;}
</style>
</head>
<body>
<div class="shape circle"></div>
<div class="shape square"></div>

<div class="card">
<h1 class="title">Status du Bot</h1>
<div id="statusBox" class="status-box">Chargement...</div>

<div class="info">
<div class="info-item"><span>Gateway :</span><span id="gateway">â€“</span></div>
<div class="info-item"><span>Shard :</span><span id="shard">â€“</span></div>
<div class="info-item"><span>Ping :</span><span id="ping">â€“</span></div>
<div class="info-item"><span>Uptime :</span><span id="uptime">â€“</span></div>
<div class="info-item"><span>Dernier heartbeat :</span><span id="heartbeat">â€“</span></div>
<div class="info-item"><span>Maintenance :</span><span id="maintenance">â€“</span></div>
</div>

<!-- ADMIN ZONE -->
<h2 class="admin-title">Panneau Admin</h2>
<div id="admin" class="admin-box">Chargement de l'authentification...</div>

</div>

<footer>Â© 2025 BumpX â€” Tous droits rÃ©servÃ©s.</footer>

<script>
// ADMIN DISCORD â€” IDs autorisÃ©s
const ADMINS = ["337868737871085578", "924263589798346762"];
let userId = null;

// VÃ©rification Discord OAuth2
async function checkLogin() {
    const params = new URLSearchParams(window.location.hash.substring(1));
    const token = params.get("access_token");

    if (!token) {
        document.getElementById("admin").innerHTML = `
            <a href="https://discord.com/api/oauth2/authorize?client_id=1439239509521989745&redirect_uri=${encodeURIComponent(window.location.href)}&response_type=token&scope=identify" class="admin-btn">
                Se connecter avec Discord
            </a>`;
        return;
    }

    const user = await fetch("https://discord.com/api/users/@me", {
        headers: { Authorization: `Bearer ${token}` }
    }).then(r => r.json());

    userId = user.id;

    if (!ADMINS.includes(user.id)) {
        document.getElementById("admin").innerHTML = `
            <b style='color:red;font-size:22px;'>â›” AccÃ¨s refusÃ©</b><br>Vous n'avez pas la permission.`;
        return;
    }

    document.getElementById("admin").innerHTML = `
        <p style='font-size:20px;margin-bottom:15px;'>Bienvenue <b>${user.username}</b></p>
        <button class="admin-btn" onclick="setMaintenance(true)">Activer maintenance</button>
        <button class="admin-btn" onclick="setMaintenance(false)">DÃ©sactiver maintenance</button>
    `;
}

// API MAINTENANCE
async function setMaintenance(state) {
    await fetch("https://bumpxbot-status.ilyesquibroute93.workers.dev/admin/maintenance", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ maintenance: state })
    });
    alert("Maintenance mise Ã  jour.");
}

// STATUS
async function loadStatus() {
    const box = document.getElementById("statusBox");

    try {
        const r = await fetch("https://bumpxbot-status.ilyesquibroute93.workers.dev/status", { cache: "no-store" });
        const data = await r.json();

        // SÃ©curise les valeurs manquantes
        const gateway = data.gateway_status ?? "N/A";
        const shard = data.shard_id ?? "N/A";
        const ping = data.latency_ms ?? "N/A";
        const uptime = data.uptime_seconds ?? "0";
        const heartbeat = data.last_heartbeat_ack ? new Date(data.last_heartbeat_ack).toLocaleString() : "N/A";
        const maintenance = data.maintenance ? "Oui" : "Non";

        // BOT OFFLINE
        if (!data.online) {
            box.textContent = "ðŸ’¥ Oups, il y a un soucis !";
            box.className = "status-box offline";

            document.getElementById("gateway").textContent = gateway;
            document.getElementById("shard").textContent = shard;
            document.getElementById("ping").textContent = ping;
            document.getElementById("uptime").textContent = uptime;
            document.getElementById("heartbeat").textContent = heartbeat;
            document.getElementById("maintenance").textContent = maintenance;
            return;
        }

        // BOT EN MAINTENANCE
        if (data.maintenance) {
            box.textContent = "ðŸŸ¡ Maintenance";
            box.className = "status-box maintenance";
        } else {
            box.textContent = "ðŸŸ¢ Bot en ligne";
            box.className = "status-box online";
        }

        // ON REMPLIT LES DONNÃ‰ES
        document.getElementById("gateway").textContent = gateway;
        document.getElementById("shard").textContent = shard;
        document.getElementById("ping").textContent = ping + " ms";
        document.getElementById("uptime").textContent = uptime + "s";
        document.getElementById("heartbeat").textContent = heartbeat;
        document.getElementById("maintenance").textContent = maintenance;

    } catch (e) {
        box.textContent = "ðŸ’¥ Oups, il y a un soucis !";
        box.className = "status-box offline";
    }
}

setInterval(loadStatus, 5000);
loadStatus();
checkLogin();
</script>

</body>
</html>
